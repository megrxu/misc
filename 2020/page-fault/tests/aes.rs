use page_fault::aes_openssl::*;

#[test]
fn test_aes_encrypt() {
    let key: [u8; 32] = [
        0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e,
        0x0f, 0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d,
        0x1e, 0x1f,
    ];

    // aes-128
    let cipher = AES::new(&key[0..16]);
    let p = [
        0x00, 0x11, 0x22, 0x33, 0x44, 0x55, 0x66, 0x77, 0x88, 0x99, 0xaa, 0xbb, 0xcc, 0xdd, 0xee,
        0xff,
    ];
    let mut c = [0u8; 16];
    cipher.encrypt(&p, &mut c);
    assert_eq!(
        c,
        [
            0x69, 0xc4, 0xe0, 0xd8, 0x6a, 0x7b, 0x4, 0x30, 0xd8, 0xcd, 0xb7, 0x80, 0x70, 0xb4,
            0xc5, 0x5a
        ]
    );
}

#[test]
fn test_pf_trace() {
    let trace1 = vec![true, false, true, false, true, false];
    let trace2 = vec![true, true, true, false, false, false];
    assert_eq!(page_trace::pf_trace(&trace1), trace1);
    assert_eq!(page_trace::pf_trace(&trace2), vec![true, false]);
}
